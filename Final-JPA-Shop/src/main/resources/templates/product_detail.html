<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
	    <meta charset="UTF-8">
	    <title>View</title>
	</head>
	<body>
	    <h1>View</h1>
	    <h1>productList</h1>
		  <a sec:authorize="isAnonymous()" th:href="@{/user/signup}">회원가입</a>
		  <a sec:authorize="isAnonymous()" th:href="@{/user/login}">로그인</a>
	      <a sec:authorize="isAuthenticated()" th:href="@{/user/logout}">로그아웃</a>
	    <div th:if="${#authorization.expression('isAuthenticated()')}">
	    	<p th:text="'안녕하세요, ' + ${#authentication.name} + '님 환영합니다.'"></p>
	    </div>
	    <!-- 상품 수정하기 버튼 -->
	    <a sec:authorize="hasRole('ROLE_ADMIN')" th:href="@{/product/edit}"></a>
	    <!-- 2번째 방법 -->
	    <a th:if="${#authorization.expression('hasRole(''ROLE_ADMIN'')')}" th:href="@{/product/edit}">상품 수정하기</a>
	   	<a sec:authorize="hasRole('ROLE_ADMIN')" th:href="@{/product/edit}"></a>
	    <div th:if="${product.imgName != null and product.imgPath != null}">
	        <img th:src="@{${product.imgPath}}"/>
	    </div>
	    <div th:unless="${product.imgName != null and product.imgPath != null}">
	        <img th:src="@{'/img/notImg.jpg'}" />
	    </div>
	    <label>상품명</label>
	    <span th:text="${product.name}"></span>
	    <br>
	    <label>상세설명</label>
	    <span th:text="${product.text}"></span>
	    <br>
	    <label>가격</label>
	    <span th:text="${product.price}"></span>
	    <br>
	    <label>재고</label>
	    <span th:text="${product.stock}"></span>
	    <br>
	    
	    <!-- 댓글 표시 -->
	    <h2>댓글</h2>
	    <div th:each="comment :  ${product.comments}">
	    	<p th:text="${comment.content}">
	    </div>
	    
	    <!-- 댓글 입력 폼 -->
	  <form th:action="@{/addComment(productId=${product.id},commentContent=${commentContent})}" method="post">
	    	<input type="hidden" name="productId" 
	    							th:value="${product.id}"/>
	    	<label>댓글 작성</label>
	    	<input type="text" id="content" name="content">
	    	<button type="submit">댓글등록</button>
	    </form>
	    
	    
	    
	    <a th:href="@{/product/list}">돌아가기</a>
	</body>
</html>